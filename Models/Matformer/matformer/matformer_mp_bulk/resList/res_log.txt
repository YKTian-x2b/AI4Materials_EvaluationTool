name='matformer' conv_layers=5 edge_layers=0 atom_input_features=92 edge_features=128 triplet_input_features=40 node_features=128 fc_layers=1 fc_features=128 output_features=1 node_layer_head=4 edge_layer_head=4 nn_based=False link='identity' zero_inflated=False use_angle=False angle_lattice=False classification=False
{'dataset': 'megnet', 'target': 'bulk modulus', 'epochs': 200, 'batch_size': 64, 'weight_decay': 1e-05, 'learning_rate': 0.001, 'criterion': 'mse', 'optimizer': 'adamw', 'scheduler': 'onecycle', 'save_dataloader': False, 'pin_memory': False, 'write_predictions': True, 'num_workers': 10, 'classification_threshold': None, 'atom_features': 'cgcnn', 'model': {'name': 'matformer', 'use_angle': False}, 'matrix_input': False, 'pyg_input': True, 'use_lattice': True, 'use_angle': False, 'neighbor_strategy': 'k-nearest', 'output_dir': 'matformer_mp_bulk', 'id_tag': 'id', 'n_train': 4664, 'n_val': 393, 'n_test': 393}
config:
{'atom_features': 'cgcnn',
 'batch_size': 64,
 'classification_threshold': None,
 'criterion': 'mse',
 'cutoff': 8.0,
 'dataset': 'megnet',
 'distributed': False,
 'epochs': 200,
 'filename': 'sample',
 'id_tag': 'id',
 'keep_data_order': False,
 'learning_rate': 0.001,
 'log_tensorboard': False,
 'matrix_input': False,
 'max_neighbors': 12,
 'model': {'angle_lattice': False,
           'atom_input_features': 92,
           'classification': False,
           'conv_layers': 5,
           'edge_features': 128,
           'edge_layer_head': 4,
           'edge_layers': 0,
           'fc_features': 128,
           'fc_layers': 1,
           'link': 'identity',
           'name': 'matformer',
           'nn_based': False,
           'node_features': 128,
           'node_layer_head': 4,
           'output_features': 1,
           'triplet_input_features': 40,
           'use_angle': False,
           'zero_inflated': False},
 'n_early_stopping': None,
 'n_test': 393,
 'n_train': 4664,
 'n_val': 393,
 'neighbor_strategy': 'k-nearest',
 'num_workers': 10,
 'optimizer': 'adamw',
 'output_dir': 'matformer_mp_bulk',
 'pin_memory': False,
 'progress': True,
 'pyg_input': True,
 'random_seed': 123,
 'save_dataloader': False,
 'scheduler': 'onecycle',
 'standard_scalar_and_pca': False,
 'store_outputs': True,
 'target': 'bulk modulus',
 'target_multiplication_factor': None,
 'test_ratio': 0.1,
 'train_ratio': 0.8,
 'use_angle': False,
 'use_canonize': True,
 'use_lattice': True,
 'val_ratio': 0.1,
 'version': '825401c11d4a21d0926204461bfda7cb4d2aa9d2',
 'warmup_steps': 2000,
 'weight_decay': 1e-05,
 'write_checkpoint': True,
 'write_predictions': True}
output_dir matformer_mp_bulk
Obtaining MEGNET-3D CFID dataset 69k...
Reference:https://pubs.acs.org/doi/10.1021/acs.chemmater.9b01294
Loading the zipfile...
Loading completed.
using mp bulk dataset
MAX val: 7960.0
MIN val: -21843.0
MAD: 66.05500882806524
Baseline MAE: 0.29028882743862783
dataConfig range 2.639486489268586 0.6020599913279624
./saved_data/train_datatest_graph_angle.pkl
graphs not saved
mean 1.935231 std 0.364286
normalize using training mean 1.935231 and std 0.364247
warning: could not load CGCNN features for 103
Setting it to max atomic number available here, 103
warning: could not load CGCNN features for 101
Setting it to max atomic number available here, 103
warning: could not load CGCNN features for 102
Setting it to max atomic number available here, 103
building line graphs
dataConfig range 2.639486489268586 0.6020599913279624
./saved_data/val_datatest_graph_angle.pkl
graphs not saved
mean 1.972748 std 0.361506
normalize using training mean 1.935231 and std 0.364247
building line graphs
dataConfig range 2.639486489268586 0.47712125471966244
./saved_data/test_datatest_graph_angle.pkl
graphs not saved
mean 1.922417 std 0.363745
normalize using training mean 1.935231 and std 0.364247
building line graphs
n_train: 4664
n_val: 393
n_test: 393
