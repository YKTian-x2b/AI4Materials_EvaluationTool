model_type: pdeformer
model:
    graphormer:
        num_node_type: 128
        num_edge_type: 8
        num_in_degree: 32
        num_out_degree: 32
        num_spatial: 16
        num_encoder_layers: 4
        embed_dim: 128
        ffn_embed_dim: 128
        num_heads: 16
        pre_layernorm: True
    scalar_encoder:
        dim_hidden: 256
        num_layers: 3
    function_encoder:
        type: weighted_deepset  # {deepset, weighted_deepset, patched}
        deepset_point_fn: poly_inr  # {mlp, poly_inr, siren}
        num_branches: 4
        dim_hidden: 512
        num_layers: 6
    inr:
        type: poly_inr
        num_layers: 4
        dim_hidden: 64
        dim_in: 2
        dim_out: 1
        poly_inr:
            enable_affine: False
            enable_shift: True
            enable_scale: True
    hypernet:
        hyper_dim_hidden: 256
        hyper_num_layers: 3
        share_hypernet: False  # whether the parameters of all INR layers are generated by the same hypernet
    load_ckpt: none
data:
    path: ../data_download
    type: multi_pde
    load_to_ram: False
    num_workers: 4
    augment: True
    num_samples_per_file:
        train: 10000
        test: 10000
    pde_dag:
        max_n_scalar_nodes: 52
        max_n_function_nodes: 3
        disconn_attn_bias: -inf
    multi_pde:
        train:
            sinus0_c:
                - custom_v4.23_sinus0_circ_cU3_k1e-03_1_seed2
                - custom_v4.23_sinus0_circ_cU3_k1e-03_1_seed3
                - custom_v4.23_sinus0_circ_cU3_k1e-03_1_seed4
                - custom_v4.23_sinus0_circ_cU3_k1e-03_1_seed5
                - custom_v4.23_sinus0_circ_cU3_k1e-03_1_seed6
            sinus0_r:
                - custom_v4.23_sinus0_robin_cU3_k1e-03_1_seed2
                - custom_v4.23_sinus0_robin_cU3_k1e-03_1_seed3
                - custom_v4.23_sinus0_robin_cU3_k1e-03_1_seed4
                - custom_v4.23_sinus0_robin_cU3_k1e-03_1_seed5
                - custom_v4.23_sinus0_robin_cU3_k1e-03_1_seed6
        test:
            sinus0_c:
                - custom_v4.23_sinus0_circ_cU3_k1e-03_1_seed1
            sinus0_r:
                - custom_v4.23_sinus0_robin_cU3_k1e-03_1_seed1
train:
    total_batch_size: 80
    num_tx_samp_pts: 8192
    lr_init: 1.e-4
    epochs: 500
    loss:
        type: RMSE  # {MSE, RMSE, MAE}
        normalize: True
        normalize_eps: 0.05
    optimizer: Adam  # {Adam, AdamW}
    weight_decay: 0.0
    lr_scheduler:
        type: cos
        enable_warmup: True
        warmup_epochs: 10
    grad_clip_value: 1  # -1 means no gradient clipping
test:
    total_batch_size: 80
    interval: 25
    plot_num_per_cls: 2
record_dir: "exp/custom-100k_model-S"
